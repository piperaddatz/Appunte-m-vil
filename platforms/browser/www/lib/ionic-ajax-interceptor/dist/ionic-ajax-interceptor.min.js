!function(){"use strict";angular.module("ionic-ajax-interceptor",["ionic"])}(),function(t){"use strict";t.provider("AjaxInterceptor",["$httpProvider",function(t){var e={title:"Error",defaultMessage:"Unknown error",authorizationHeader:"Authorization",authorizationToken:null,stateChangeError:!0,fallbackIp:null,transformRequest:null,transformResponse:null};return{config:function(n){angular.extend(e,n),t.interceptors.push(["$rootScope","$q","$injector",function(t,n,r){return{request:function(n){return t.$broadcast("loading:show"),e.authorizationToken&&(n.headers[e.authorizationHeader]=e.authorizationToken),n},requestError:function(e){return t.$broadcast("loading:hide"),n.reject(e)},response:function(e){return t.$broadcast("loading:hide"),e},responseError:function(o){if(0==o.status){var a=o.config.url.split("/");if(a[2]!==e.fallbackIp){a[2]=e.fallbackIp,o.config.url=a.join("/");var i=r.get("$http");return i(o.config)}}return t.$broadcast("loading:hide"),n.reject(o)}}}]),e.transformRequest&&t.defaults.transformRequest.push(e.transformRequest),e.transformResponse&&t.defaults.transformResponse.push(e.transformResponse)},$get:["$ionicPopup","$ionicLoading","$rootScope","$http",function(t,n,r,o){var a=0,i=function(){0===a&&n.show({content:"Loading",animation:"fade-in",showBackdrop:!0,maxWidth:200,showDelay:0}),a++},u=function(){a--,0==a?n.hide():0>a&&(a=0)};return{run:function(){e.stateChangeError&&r.$on("$stateChangeError",function(n,r,o,a,i,u){t.alert({title:e.title,content:u.message||e.defaultMessage})}),r.$on("loading:show",function(){i()}),r.$on("loading:hide",function(){u()})},setAuthorizationToken:function(t){e.authorizationToken=t},showLoading:function(){i()},hideLoading:function(){u()}}}]}}])}(angular.module("ionic-ajax-interceptor")),function(t){"use strict";var e="iHttp_";t.factory("AjaxService",["$http","$q",function(t,n){return{config:function(t){t.hasOwnProperty(prefix)&&(e=t.prefix)},http:function(r){var o,a;if(r.iCache){o=e,a=r.iCache.expires,o+=r.iCache.hasOwnProperty("key")?r.iCache.key:r.url;var i=localStorage.getItem(o);if(i){var u=JSON.parse(i);if(!u.timestamp||u.timestamp>(new Date).getTime())return n.resolve({data:u.data})}delete r.iCache}var c=n.defer();return t(r).then(function(t){if(o&&t.data){var e=JSON.stringify({timestamp:a,data:t.data});localStorage.setItem(o,e)}c.resolve(t)},function(t){c.reject(t)}),c.promise},clearCache:function(){for(var t in localStorage)localStorage.hasOwnProperty(t)&&0==t.indexOf(e)&&localStorage.removeItem(t)}}}])}(angular.module("ionic-ajax-interceptor"));